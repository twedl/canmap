---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# canmap

<!-- badges: start -->
<!-- badges: end -->

```canmap``` provides easy access to standard Canadian geographic shapefiles, as well as the associated metadata that helps pick which one you'd like.

## Installation

You can install the development version of ```canmap``` with:

``` r
remotes::install_github("tweed1e/canmap")
```

## Example


```{r example}
library(canmap)

tibble::as_tibble(shapefile_paths)

# then pick a shapefile and get the link:
(url <- shapefile_paths[1, ]$path)

# then you can download it yourself, or use download_geography(url)
```


## Documentation 


A list of useful links to clean up later:

* [Geography definitions and documentation](https://www.statcan.gc.ca/eng/subjects/standard/sgc/geography)
* [Root for geography downloads and documentation](https://www12.statcan.gc.ca/census-recensement/2016/geo/index-eng.cfm) 
* [Direct link to download directory for 2016 shapefiles](https://www12.statcan.gc.ca/census-recensement/2011/geo/bound-limit/bound-limit-2016-eng.cfm)
* [Heirarchy of geography](https://www150.statcan.gc.ca/n1/pub/92-195-x/2011001/other-autre/hierarch/h-eng.htm)


### Parsing the filename for metadata

Suppose you've downloaded the geography file ```lpr_000a16a_e.zip```. The filename defines the important geographic characteristics of the file (you can process using the ```code_pos``` dataset for code positions, or ```get_geoinfo```).

```{r codes, warning = FALSE, message = FALSE}
str(geoinfo("lpr_000a16a_e"))
```

And each of these codes has a meaning that can be found (sometimes) in the geography guide that accompanies a downloaded file (but you can't find out the details until *after* you've downloaded it, and is missing some information).

Your first default parameters should be: 

- ```file_type == "a"``` (digital boundary file---it doesn't look as good but it's smaller) 
- ```format == "a"``` (ArcGIS/ArcInfoÂ®/.shp---for use with ```sf``` and other ```R``` geographic packages)
- ```geo_coverage == "000"``` (Canada---the only option AFAIK)
- ```projection == "g"``` (geographic projection/lat-long---this makes it less likely for the user to get caught up in coordinate reference systems [CRS] conversion issues)

The most important choices for the user are: year (2016 is the latest census year currently available), language (english or french) and geo_code/geo_level. A list of geo codes and geo levels are given in the ```code_book``` dataset:

``` {r geos}
dplyr::filter(code_book, code_type == "geo_level")
```

Business data usually isn't released below the economic region level (```er_```), while census data can go down to census tract (```ct_```), dissemination area (```da_```) or dissemination block (```db_```). 

These are english codes, while the french codes are also in the dataset---english and french maps are in different files, so they have different codes: ```lpr_000a16a_e.zip``` has the english province/territory maps and ```lpr_000a16a_f.zip``` has the french province/territory maps. The only difference, AFAIK, is that the guide and geography names are in french in the french version.


## Download and extract shapefiles to ```./geography/```

``` {r eval = FALSE}
download_geography(url)
```


## Notes

Please note that the 'canmap' project is released with a
[Contributor Code of Conduct](.github/CODE_OF_CONDUCT.md).
By contributing to this project, you agree to abide by its terms.
